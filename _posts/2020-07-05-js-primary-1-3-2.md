---
title: 【JS知识体系：1-3-2】this
date:  2020-07-05 14:09:20 +0800
category: 前端
tags: ['JS', 'JS基础知识']
excerpt: 通过上下文理解this，那又该如何理解上下文
---



# this

> **前言：** 黑暗之中，还能抓得住什么？是否有一颗星星能告诉我。Where is this?



接着上文讲。上文我们讲到了加载js代码后，首先会创建全局上下文，调用函数会创建新的函数执行上下文，其实还有一种上下文，即通过eval()函数创建的上下文。

创建了上下文之后，上下文会经历三个阶段，**创建 => 执行 => 回收**

在创建阶段就提到了，该阶段会确定this的指向。



那么this是什么，this的指向又是如何确定的？



## 1. this是什么

this是一个关键字，不是变量，也不是属性名。js语法不支持给this赋值。

不管何时何地，只要代码在运行，你就可以访问this

this没有作用域的限制，嵌套的函数不会从它的外层函数继承this。



## 2. this指向

这个问题我已经在很多文章和教程中得到了一个精简的答案：

> this指向当前的代码的运行环境

但我觉的这个回答并不精悍(凡是不能让我觉的醍醐灌顶的回答都是不精悍的回答)。

于是乎我去查看了ECMAScript是如何说明的，ECMAScript5.1标准中提到

### 2.1 进入全局代码

1. 将变量环境设置为 全局环境
2. 将此法环境设置为 全局环境
3. 将this绑定设置为 全局对象



### 2.2 进入eval代码

eval函数不推荐使用，这里先略过。



### 2.3 进入函数代码

当控制流根据一个函数对象 F、调用者提供的 thisArg 以及调用者提供的 argumentList，进入 函数代码 的执行环境时，执行以下步骤：

1. 如果 函数代码 是 严格模式下的代码 ，设 this 绑定为 thisArg。
2. 否则如果 thisArg 是 null 或 undefined，则设 this 绑定为 全局对象 。
3. 否则如果 Type(thisArg) 的结果不为 Object，则设 this 绑定为 ToObject(thisArg)。
4. 否则设 this 绑定为 thisArg。
5. 以 F 的 [[Scope]] 内部属性为参数调用 NewDeclarativeEnvironment，并令 localEnv 为调用的结果。
6. 设词法环境为 localEnv。
7. 设变量环境为 localEnv。
8. 令 code 为 F 的 [[Code]] 内部属性的值。
9. 按 [10.5](#10.5) 描述的方案，使用 函数代码 code 和 argumentList 执行定义绑定初始化步骤。



emm...**😟**

看不懂，先强行记忆吧。。。



> - 在方法中，this 表示该方法所属的对象。
> - 如果单独使用，this 表示全局对象。
> - 在函数中，this 表示全局对象。
> - 在函数中，在严格模式下，this 是未定义的(undefined)。
> - 在事件中，this 表示接收事件的元素。
> - 类似 call() 和 apply() 方法可以将 this 引用到任何对象。



等我研究完再来更新...





